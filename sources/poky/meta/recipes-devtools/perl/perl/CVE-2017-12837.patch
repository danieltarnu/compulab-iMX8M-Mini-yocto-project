From 73d7247ecab863ef26b5687a37ccc75d6144ad0f Mon Sep 17 00:00:00 2001
From: Karl Williamson <khw@cpan.org>
Date: Tue, 17 Oct 2017 13:49:14 +0800
Subject: [PATCH] fix CVE-2017-12837

Signed-off-by: Karl Williamson <khw@cpan.org>
Signed-off-by: Steve Hay <steve.m.hay@googlemail.com>

CVE: CVE-2017-12837
Upstream-Status: Backport
https://perl5.git.perl.org/perl.git/commitdiff/96c83ed78aeea1a0496dd2b2d935869a822dc8a5

Signed-off-by: Hongxu Jia <hongxu.jia@windriver.com>
---
 regcomp.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/regcomp.c b/regcomp.c
index 5498d14..31ec383 100644
--- a/regcomp.c
+++ b/regcomp.c
@@ -13021,6 +13021,7 @@ S_regatom(pTHX_ RExC_state_t *pRExC_state, I32 *flagp, U32 depth)
                             goto loopdone;
                         }
                         p = RExC_parse;
+                        RExC_parse = parse_start;
                         if (ender > 0xff) {
                             REQUIRE_UTF8(flagp);
                         }
-- 
1.8.3.1

